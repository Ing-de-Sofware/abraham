# ARQUITECTURA DEL SISTEMA - DETECCIÃ“N DE HELIOTHIS VIRESCENS
## Sistema Inteligente basado en Deep Learning y AnÃ¡lisis Multimodal para Cultivos de ArÃ¡ndanos

---

## 1. PROPUESTA DE SOLUCIÃ“N

**Sistema Inteligente de DetecciÃ³n Temprana de *Heliothis virescens* en Cultivos de ArÃ¡ndanos**

### Â¿QuÃ© hace la soluciÃ³n?

Plataforma web/mÃ³vil que permite a agricultores y tÃ©cnicos capturar imÃ¡genes de plantas de arÃ¡ndano con sus smartphones, procesarlas con modelos de deep learning en la nube, y recibir diagnÃ³sticos instantÃ¡neos sobre la presencia de la plaga *Heliothis virescens* en estadios tempranos.

### Problema que Soluciona

- **DetecciÃ³n tardÃ­a**: PÃ©rdidas del 30-40% de cosecha por identificaciÃ³n cuando el daÃ±o ya es visible
- **InspecciÃ³n manual**: Alto margen de error humano y proceso lento que requiere expertos
- **Falta de datos**: No hay registro histÃ³rico ni anÃ¡lisis predictivo de brotes

### Aporte Innovador y Valor Agregado

1. **DetecciÃ³n Temprana con IA**: Identifica plagas en estadios larvarios L1-L2 (< 5mm) antes de daÃ±os visibles
2. **AnÃ¡lisis Multimodal Inteligente**: Combina visiÃ³n por computadora + datos ambientales locales (temperatura, humedad, fenologÃ­a)
3. **Accesible desde MÃ³vil**: Solo necesita smartphone con cÃ¡mara, funciona como PWA sin instalaciÃ³n
4. **Alertas en Tiempo Real**: Notificaciones push + dashboard con mapas de calor de infestaciÃ³n
5. **Historial y PredicciÃ³n**: Machine learning predice prÃ³ximos brotes basado en patrones histÃ³ricos

### Para QuiÃ©n EstÃ¡ Dirigida

- **Agricultores**: PequeÃ±os y medianos productores de arÃ¡ndanos en VirÃº
- **Empresas Agroexportadoras**: Como Fagro LatinoamÃ©rica SAC
- **TÃ©cnicos de Campo**: Ingenieros agrÃ³nomos y supervisores de cultivo
- **Gerentes**: Decisores que requieren reportes y analytics

### TecnologÃ­as Principales Empleadas

**Frontend/MÃ³vil:**
```
â€¢ React 18.3 + TypeScript
â€¢ Progressive Web App (PWA)
â€¢ Material-UI (MUI) v5
â€¢ Recharts para visualizaciones
â€¢ Leaflet para mapas georreferenciados
```

**Backend/API:**
```
â€¢ FastAPI 0.115+ (Python 3.11)
â€¢ Node.js 20 + Express (WebSocket)
â€¢ PostgreSQL 16 (datos estructurados)
â€¢ MongoDB 7 (imÃ¡genes + logs)
â€¢ Redis 7 (cache + colas)
```

**Deep Learning:**
```
â€¢ PyTorch 2.5 + CUDA 12.1
â€¢ YOLOv8 optimizado + CBAM
â€¢ TorchVision + Albumentations
â€¢ ONNX Runtime (optimizaciÃ³n)
```

**Cloud Infrastructure:**
```
â€¢ AWS EC2 (GPU: g4dn.xlarge - NVIDIA T4)
â€¢ AWS S3 (almacenamiento imÃ¡genes)
â€¢ AWS RDS (PostgreSQL)
â€¢ AWS EKS (Kubernetes)
â€¢ CloudWatch (monitoring)
```

---

## 2. DISEÃ‘O DE SOLUCIÃ“N - DIAGRAMA ARQUITECTÃ“NICO

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              USUARIOS FINALES                                â”‚
â”‚                                                                               â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚    â”‚  Agricultor  â”‚     â”‚   TÃ©cnico    â”‚     â”‚   Supervisor â”‚              â”‚
â”‚    â”‚              â”‚     â”‚   AgrÃ³nomo   â”‚     â”‚   /Gerente   â”‚              â”‚
â”‚    â”‚ Smartphone   â”‚     â”‚   Tablet     â”‚     â”‚    Laptop    â”‚              â”‚
â”‚    â”‚ (CÃ¡mara)     â”‚     â”‚ (CÃ¡mara)     â”‚     â”‚   Desktop    â”‚              â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                    â”‚                    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Internet / 4G / 5G    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          AWS CLOUD INFRASTRUCTURE                           â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    CloudFront CDN + SSL/TLS                         â”‚   â”‚
â”‚  â”‚                 â€¢ DistribuciÃ³n global de contenido                  â”‚   â”‚
â”‚  â”‚                 â€¢ Cache estÃ¡tico (imÃ¡genes, CSS, JS)                â”‚   â”‚
â”‚  â”‚                 â€¢ Certificado SSL Let's Encrypt                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    API Gateway (Kong / AWS ALB)                     â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   âœ“ AutenticaciÃ³n JWT (OAuth 2.0)                                  â”‚   â”‚
â”‚  â”‚   âœ“ Rate Limiting (100 req/min por usuario)                        â”‚   â”‚
â”‚  â”‚   âœ“ Load Balancing (Round Robin)                                   â”‚   â”‚
â”‚  â”‚   âœ“ CORS habilitado para PWA                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                â”‚                                             â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚         â”‚                      â”‚                      â”‚                    â”‚
â”‚         â–¼                      â–¼                      â–¼                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  FRONTEND   â”‚      â”‚   BACKEND   â”‚      â”‚  WEBSOCKET  â”‚              â”‚
â”‚  â”‚   LAYER     â”‚â—„â”€â”€â”€â”€â–ºâ”‚    LAYER    â”‚â—„â”€â”€â”€â”€â–ºâ”‚   SERVER    â”‚              â”‚
â”‚  â”‚             â”‚ REST â”‚             â”‚ Pub  â”‚             â”‚              â”‚
â”‚  â”‚  React 18   â”‚ API  â”‚  FastAPI    â”‚ Sub  â”‚  Node.js    â”‚              â”‚
â”‚  â”‚  TypeScript â”‚      â”‚  Python     â”‚      â”‚  Express    â”‚              â”‚
â”‚  â”‚  Material-UIâ”‚      â”‚             â”‚      â”‚             â”‚              â”‚
â”‚  â”‚  PWA        â”‚      â”‚  Uvicorn    â”‚      â”‚  Socket.IO  â”‚              â”‚
â”‚  â”‚             â”‚      â”‚             â”‚      â”‚             â”‚              â”‚
â”‚  â”‚  Port: 443  â”‚      â”‚  Port: 8000 â”‚      â”‚  Port: 3000 â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                               â”‚                                             â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚                    â”‚                     â”‚                                 â”‚
â”‚                    â–¼                     â–¼                                 â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚         â”‚  AUTH SERVICE    â”‚  â”‚ DETECTION SERVICEâ”‚                        â”‚
â”‚         â”‚                  â”‚  â”‚                  â”‚                        â”‚
â”‚         â”‚ â€¢ Login/Register â”‚  â”‚ â€¢ Upload Image   â”‚                        â”‚
â”‚         â”‚ â€¢ JWT Tokens     â”‚  â”‚ â€¢ Process ML     â”‚                        â”‚
â”‚         â”‚ â€¢ RBAC           â”‚  â”‚ â€¢ Return Results â”‚                        â”‚
â”‚         â”‚                  â”‚  â”‚                  â”‚                        â”‚
â”‚         â”‚ FastAPI          â”‚  â”‚ FastAPI + PyTorchâ”‚                        â”‚
â”‚         â”‚ Port: 5001       â”‚  â”‚ Port: 5002       â”‚                        â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                        â”‚                                   â”‚
â”‚                                        â–¼                                   â”‚
â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                          â”‚   AI/ML INFERENCE LAYER  â”‚                     â”‚
â”‚                          â”‚                          â”‚                     â”‚
â”‚                          â”‚  EC2 g4dn.xlarge (GPU)  â”‚                     â”‚
â”‚                          â”‚  NVIDIA Tesla T4 16GB    â”‚                     â”‚
â”‚                          â”‚                          â”‚                     â”‚
â”‚                          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                     â”‚
â”‚                          â”‚  â”‚ 1. Preprocessing   â”‚ â”‚                     â”‚
â”‚                          â”‚  â”‚  â€¢ Resize 640x640  â”‚ â”‚                     â”‚
â”‚                          â”‚  â”‚  â€¢ Normalize       â”‚ â”‚                     â”‚
â”‚                          â”‚  â”‚  â€¢ Augment         â”‚ â”‚                     â”‚
â”‚                          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                     â”‚
â”‚                          â”‚            â”‚            â”‚                     â”‚
â”‚                          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                     â”‚
â”‚                          â”‚  â”‚ 2. YOLOv8 + CBAM   â”‚ â”‚                     â”‚
â”‚                          â”‚  â”‚  â€¢ Detection       â”‚ â”‚                     â”‚
â”‚                          â”‚  â”‚  â€¢ Classification  â”‚ â”‚                     â”‚
â”‚                          â”‚  â”‚  â€¢ Tracking        â”‚ â”‚                     â”‚
â”‚                          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                     â”‚
â”‚                          â”‚            â”‚            â”‚                     â”‚
â”‚                          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                     â”‚
â”‚                          â”‚  â”‚ 3. Multimodal      â”‚ â”‚                     â”‚
â”‚                          â”‚  â”‚  Fusion            â”‚ â”‚                     â”‚
â”‚                          â”‚  â”‚  â€¢ CNN + Env Data  â”‚ â”‚                     â”‚
â”‚                          â”‚  â”‚  â€¢ MLP Classifier  â”‚ â”‚                     â”‚
â”‚                          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                     â”‚
â”‚                          â”‚            â”‚            â”‚                     â”‚
â”‚                          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                     â”‚
â”‚                          â”‚  â”‚ 4. Post-process    â”‚ â”‚                     â”‚
â”‚                          â”‚  â”‚  â€¢ NMS             â”‚ â”‚                     â”‚
â”‚                          â”‚  â”‚  â€¢ Confidence      â”‚ â”‚                     â”‚
â”‚                          â”‚  â”‚  â€¢ Format output   â”‚ â”‚                     â”‚
â”‚                          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                     â”‚
â”‚                          â”‚                          â”‚                     â”‚
â”‚                          â”‚  Inferencia: ~45ms/img  â”‚                     â”‚
â”‚                          â”‚  Throughput: 22 img/s   â”‚                     â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                        â”‚                                   â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚         â”‚                              â”‚                      â”‚          â”‚
â”‚         â–¼                              â–¼                      â–¼          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ PostgreSQL  â”‚            â”‚  MongoDB 7  â”‚        â”‚   Redis 7   â”‚     â”‚
â”‚  â”‚     16      â”‚            â”‚             â”‚        â”‚             â”‚     â”‚
â”‚  â”‚             â”‚            â”‚             â”‚        â”‚             â”‚     â”‚
â”‚  â”‚ RDS Multi-AZâ”‚            â”‚ DocumentDB  â”‚        â”‚ ElastiCache â”‚     â”‚
â”‚  â”‚             â”‚            â”‚             â”‚        â”‚             â”‚     â”‚
â”‚  â”‚ â€¢ users     â”‚            â”‚ â€¢ images    â”‚        â”‚ â€¢ sessions  â”‚     â”‚
â”‚  â”‚ â€¢ detectionsâ”‚            â”‚ â€¢ metadata  â”‚        â”‚ â€¢ cache     â”‚     â”‚
â”‚  â”‚ â€¢ alerts    â”‚            â”‚ â€¢ logs      â”‚        â”‚ â€¢ queues    â”‚     â”‚
â”‚  â”‚ â€¢ reports   â”‚            â”‚ â€¢ timestampsâ”‚        â”‚ â€¢ pub/sub   â”‚     â”‚
â”‚  â”‚             â”‚            â”‚             â”‚        â”‚             â”‚     â”‚
â”‚  â”‚ 500GB SSD   â”‚            â”‚ 500GB SSD   â”‚        â”‚ 16GB RAM    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                              â”‚                                 â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                                â”‚                                          â”‚
â”‚                                â–¼                                          â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚                   â”‚      AWS S3 Buckets     â”‚                            â”‚
â”‚                   â”‚                         â”‚                            â”‚
â”‚                   â”‚ â€¢ raw-images/           â”‚                            â”‚
â”‚                   â”‚ â€¢ processed-images/     â”‚                            â”‚
â”‚                   â”‚ â€¢ ml-models/            â”‚                            â”‚
â”‚                   â”‚ â€¢ reports-pdf/          â”‚                            â”‚
â”‚                   â”‚                         â”‚                            â”‚
â”‚                   â”‚ Lifecycle:              â”‚                            â”‚
â”‚                   â”‚ â€¢ S3 Standard (30 dÃ­as) â”‚                            â”‚
â”‚                   â”‚ â€¢ S3-IA (60 dÃ­as)       â”‚                            â”‚
â”‚                   â”‚ â€¢ Glacier (>90 dÃ­as)    â”‚                            â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    MONITORING & LOGGING                             â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  CloudWatch: Logs + Metrics + Alarms                               â”‚ â”‚
â”‚  â”‚  Prometheus + Grafana: Dashboards personalizados                   â”‚ â”‚
â”‚  â”‚  X-Ray: Distributed tracing                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**CaracterÃ­sticas Clave:**
- âœ… **Acceso Universal**: Cualquier smartphone con cÃ¡mara
- âœ… **Procesamiento en la Nube**: No requiere hardware especializado
- âœ… **Escalable**: Auto-scaling basado en demanda
- âœ… **Alta Disponibilidad**: Multi-AZ con failover automÃ¡tico
- âœ… **Seguro**: EncriptaciÃ³n end-to-end + autenticaciÃ³n robusta

---

## 3. DIAGRAMA DE COMPONENTES - MICROSERVICIOS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ARQUITECTURA DE MICROSERVICIOS                  â”‚
â”‚                         Kubernetes EKS Cluster                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   Ingress NGINX     â”‚
                        â”‚   Load Balancer     â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚                 â”‚                 â”‚                 â”‚
                 â–¼                 â–¼                 â–¼                 â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Auth      â”‚   â”‚ Detection   â”‚   â”‚ Environment â”‚   â”‚   Alert     â”‚
        â”‚  Service    â”‚   â”‚  Service    â”‚   â”‚  Service    â”‚   â”‚  Service    â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚             â”‚   â”‚             â”‚   â”‚             â”‚   â”‚             â”‚
        â”‚â€¢ Login      â”‚   â”‚â€¢ Upload Img â”‚   â”‚â€¢ Weather    â”‚   â”‚â€¢ Push Notif â”‚
        â”‚â€¢ Register   â”‚   â”‚â€¢ Inference  â”‚   â”‚  API        â”‚   â”‚â€¢ Email      â”‚
        â”‚â€¢ JWT Auth   â”‚   â”‚â€¢ Store      â”‚   â”‚â€¢ Historical â”‚   â”‚â€¢ SMS        â”‚
        â”‚â€¢ User Mgmt  â”‚   â”‚  Results    â”‚   â”‚  Data       â”‚   â”‚â€¢ WebSocket  â”‚
        â”‚â€¢ RBAC       â”‚   â”‚â€¢ Tracking   â”‚   â”‚â€¢ Multimodal â”‚   â”‚             â”‚
        â”‚             â”‚   â”‚             â”‚   â”‚  Features   â”‚   â”‚             â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚  FastAPI    â”‚   â”‚  FastAPI    â”‚   â”‚  Node.js    â”‚   â”‚  Node.js    â”‚
        â”‚  Python     â”‚   â”‚  PyTorch    â”‚   â”‚  Express    â”‚   â”‚  Express    â”‚
        â”‚             â”‚   â”‚             â”‚   â”‚             â”‚   â”‚             â”‚
        â”‚  Replicas:3 â”‚   â”‚  Replicas:5 â”‚   â”‚  Replicas:2 â”‚   â”‚  Replicas:2 â”‚
        â”‚  CPU: 1vCPU â”‚   â”‚  GPU: T4    â”‚   â”‚  CPU: 1vCPU â”‚   â”‚  CPU: 1vCPU â”‚
        â”‚  RAM: 2GB   â”‚   â”‚  RAM: 8GB   â”‚   â”‚  RAM: 2GB   â”‚   â”‚  RAM: 2GB   â”‚
        â”‚             â”‚   â”‚             â”‚   â”‚             â”‚   â”‚             â”‚
        â”‚  Port: 5001 â”‚   â”‚  Port: 5002 â”‚   â”‚  Port: 5003 â”‚   â”‚  Port: 5004 â”‚
        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
               â”‚                 â”‚                 â”‚                 â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Message Broker          â”‚
                    â”‚    RabbitMQ / Amazon SQS   â”‚
                    â”‚                            â”‚
                    â”‚  Queues:                   â”‚
                    â”‚  â€¢ image.processing        â”‚
                    â”‚  â€¢ detection.results       â”‚
                    â”‚  â€¢ alert.notifications     â”‚
                    â”‚  â€¢ report.generation       â”‚
                    â”‚                            â”‚
                    â”‚  Exchanges:                â”‚
                    â”‚  â€¢ direct (routing)        â”‚
                    â”‚  â€¢ fanout (broadcast)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚               â”‚               â”‚
                 â–¼               â–¼               â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ PostgreSQL  â”‚ â”‚  MongoDB    â”‚ â”‚   Redis     â”‚
        â”‚     16      â”‚ â”‚     7       â”‚ â”‚     7       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ventajas de Microservicios:**
- ğŸ”¹ **Escalamiento Independiente**: Solo Detection Service necesita GPU
- ğŸ”¹ **Despliegue Continuo**: Deploy de un servicio sin afectar otros
- ğŸ”¹ **Tolerancia a Fallos**: Falla de Auth no afecta Detection
- ğŸ”¹ **TecnologÃ­a Flexible**: FastAPI + Node.js segÃºn necesidad

---

## 4. ARQUITECTURA DEL MODELO DE DEEP LEARNING

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  YOLOv8 + CBAM - Arquitectura Optimizada                  â”‚
â”‚                   Para DetecciÃ³n de Heliothis virescens                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    INPUT: Imagen desde Smartphone                         â”‚
â”‚                    Original: Variable (1080p, 4K, etc)                    â”‚
â”‚                    Procesada: 640 x 640 x 3 (RGB)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PREPROCESAMIENTO                                  â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  1. Resize & Padding                                          â”‚       â”‚
â”‚  â”‚     â€¢ Letterbox resize â†’ 640x640                              â”‚       â”‚
â”‚  â”‚     â€¢ Mantiene aspect ratio                                   â”‚       â”‚
â”‚  â”‚     â€¢ Padding con color medio                                 â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                               â”‚                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  2. NormalizaciÃ³n                                             â”‚       â”‚
â”‚  â”‚     â€¢ RGB â†’ [0, 1]                                            â”‚       â”‚
â”‚  â”‚     â€¢ Mean: [0.485, 0.456, 0.406]                            â”‚       â”‚
â”‚  â”‚     â€¢ Std: [0.229, 0.224, 0.225]                             â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                               â”‚                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  3. Ajustes de Calidad                                        â”‚       â”‚
â”‚  â”‚     â€¢ CLAHE (contraste adaptativo)                            â”‚       â”‚
â”‚  â”‚     â€¢ Gaussian blur (reducciÃ³n ruido)                         â”‚       â”‚
â”‚  â”‚     â€¢ Sharpening (nitidez)                                    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                            â”‚
â”‚  Frameworks: OpenCV, Albumentations, PIL                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKBONE - CSPDarknet53 con CBAM                       â”‚
â”‚                                                                            â”‚
â”‚  Conv2D(3â†’32, 6x6, stride=2)  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  320x320x32                   â”‚
â”‚           â”‚                                                                â”‚
â”‚           â–¼                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚  C3 Block 1 (64 filters)     â”‚  â”€â”€â”€â”€â”€â”€â–º  P3: 160x160x64              â”‚
â”‚  â”‚  â€¢ Conv + Bottleneck (Ã—3)    â”‚              â”‚                         â”‚
â”‚  â”‚  â€¢ Skip connection           â”‚              â”‚                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                         â”‚
â”‚                 â”‚                               â”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚                         â”‚
â”‚  â”‚  C3 Block 2 (128 filters)    â”‚  â”€â”€â”€â”€â”€â”€â–º  P4: 80x80x128               â”‚
â”‚  â”‚  â€¢ Conv + Bottleneck (Ã—6)    â”‚              â”‚                         â”‚
â”‚  â”‚  â€¢ Skip connection           â”‚              â”‚                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                         â”‚
â”‚                 â”‚                               â”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚                         â”‚
â”‚  â”‚  C3 Block 3 (256 filters)    â”‚  â”€â”€â”€â”€â”€â”€â–º  P5: 40x40x256               â”‚
â”‚  â”‚  â€¢ Conv + Bottleneck (Ã—9)    â”‚              â”‚                         â”‚
â”‚  â”‚  â€¢ Skip connection           â”‚              â”‚                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                         â”‚
â”‚                 â”‚                               â”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚                         â”‚
â”‚  â”‚  C3 Block 4 (512 filters)    â”‚  â”€â”€â”€â”€â”€â”€â–º  P6: 20x20x512               â”‚
â”‚  â”‚  â€¢ Conv + Bottleneck (Ã—3)    â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚                 â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚  SPPF (Spatial Pyramid Pooling Fast)                 â”‚                â”‚
â”‚  â”‚  â€¢ MaxPool 5x5, 9x9, 13x13                           â”‚                â”‚
â”‚  â”‚  â€¢ Concatenate all scales                            â”‚                â”‚
â”‚  â”‚  â€¢ Conv 1x1 para reducir dimensionalidad             â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                 â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚  CBAM - Convolutional Block Attention Module         â”‚                â”‚
â”‚  â”‚                                                        â”‚                â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚                â”‚
â”‚  â”‚  â”‚  Channel Attention                            â”‚   â”‚                â”‚
â”‚  â”‚  â”‚  â€¢ Global Avg Pool + Global Max Pool         â”‚   â”‚                â”‚
â”‚  â”‚  â”‚  â€¢ Shared MLP (512â†’128â†’512)                  â”‚   â”‚                â”‚
â”‚  â”‚  â”‚  â€¢ Element-wise sum â†’ Sigmoid                â”‚   â”‚                â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚                â”‚
â”‚  â”‚                   â”‚                                   â”‚                â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚                â”‚
â”‚  â”‚  â”‚  Spatial Attention                            â”‚   â”‚                â”‚
â”‚  â”‚  â”‚  â€¢ Avg + Max across channels                 â”‚   â”‚                â”‚
â”‚  â”‚  â”‚  â€¢ Conv 7x7                                   â”‚   â”‚                â”‚
â”‚  â”‚  â”‚  â€¢ Sigmoid activation                         â”‚   â”‚                â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚                â”‚
â”‚  â”‚                                                        â”‚                â”‚
â”‚  â”‚  Resultado: Features con atenciÃ³n refinada           â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ P3            â”‚ P4            â”‚ P5
                 â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    NECK - PANet + BiFPN                                   â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Bidirectional Feature Pyramid Network                         â”‚      â”‚
â”‚  â”‚                                                                 â”‚      â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚      â”‚
â”‚  â”‚  â”‚  Top-Down Pathway (AgregaciÃ³n semÃ¡ntica)            â”‚      â”‚      â”‚
â”‚  â”‚  â”‚                                                       â”‚      â”‚      â”‚
â”‚  â”‚  â”‚  P5 (20x20x512) â”€â”€â”€â”€â–º Upsample 2x â”€â”€â”              â”‚      â”‚      â”‚
â”‚  â”‚  â”‚                                       â–¼               â”‚      â”‚      â”‚
â”‚  â”‚  â”‚  P4 (40x40x256) â”€â”€â–º Concat â”€â”€â–º Conv â”€â”€â–º P4'        â”‚      â”‚      â”‚
â”‚  â”‚  â”‚                                       â”‚               â”‚      â”‚      â”‚
â”‚  â”‚  â”‚  P4' â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Upsample 2x â”€â”€â”€â”˜              â”‚      â”‚      â”‚
â”‚  â”‚  â”‚                                       â–¼               â”‚      â”‚      â”‚
â”‚  â”‚  â”‚  P3 (80x80x128) â”€â”€â–º Concat â”€â”€â–º Conv â”€â”€â–º P3'        â”‚      â”‚      â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚      â”‚
â”‚  â”‚                                                                 â”‚      â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚      â”‚
â”‚  â”‚  â”‚  Bottom-Up Pathway (Refinamiento localizaciÃ³n)      â”‚      â”‚      â”‚
â”‚  â”‚  â”‚                                                       â”‚      â”‚      â”‚
â”‚  â”‚  â”‚  P3' â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Downsample 2x â”€â”€â”                â”‚      â”‚      â”‚
â”‚  â”‚  â”‚                                      â–¼                â”‚      â”‚      â”‚
â”‚  â”‚  â”‚  P4' (from above) â”€â”€â–º Add â”€â”€â–º Conv â”€â”€â–º P4''        â”‚      â”‚      â”‚
â”‚  â”‚  â”‚                                      â”‚                â”‚      â”‚      â”‚
â”‚  â”‚  â”‚  P4'' â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Downsample 2x â”€â”€â”€â”˜               â”‚      â”‚      â”‚
â”‚  â”‚  â”‚                                      â–¼                â”‚      â”‚      â”‚
â”‚  â”‚  â”‚  P5' (from above) â”€â”€â–º Add â”€â”€â–º Conv â”€â”€â–º P5''        â”‚      â”‚      â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚      â”‚
â”‚  â”‚                                                                 â”‚      â”‚
â”‚  â”‚  Weighted Feature Fusion (BiFPN):                             â”‚      â”‚
â”‚  â”‚  â€¢ Learnable weights para cada conexiÃ³n                       â”‚      â”‚
â”‚  â”‚  â€¢ Fast normalized fusion                                      â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                â”‚                â”‚
                 â”‚ P3'' (80x80)   â”‚ P4'' (40x40)  â”‚ P5'' (20x20)
                 â–¼                â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DETECTION HEAD (Anchor-Free)                           â”‚
â”‚                                                                            â”‚
â”‚  Para cada escala P3, P4, P5:                                            â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  1. Classification Branch                                 â”‚           â”‚
â”‚  â”‚     Conv(3x3) â†’ BN â†’ SiLU â†’ Conv(3x3) â†’ BN â†’ SiLU â†’     â”‚           â”‚
â”‚  â”‚     Conv(1x1) â†’ Softmax                                   â”‚           â”‚
â”‚  â”‚     Output: [B, H, W, num_classes]                       â”‚           â”‚
â”‚  â”‚     num_classes = 2 (background, H. virescens)           â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  2. Bounding Box Regression Branch                        â”‚           â”‚
â”‚  â”‚     Conv(3x3) â†’ BN â†’ SiLU â†’ Conv(3x3) â†’ BN â†’ SiLU â†’     â”‚           â”‚
â”‚  â”‚     Conv(1x1)                                             â”‚           â”‚
â”‚  â”‚     Output: [B, H, W, 4]  donde 4 = [x, y, w, h]        â”‚           â”‚
â”‚  â”‚     Coordenadas normalizadas [0, 1]                       â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  3. Objectness Branch                                     â”‚           â”‚
â”‚  â”‚     Conv(3x3) â†’ BN â†’ SiLU â†’ Conv(1x1) â†’ Sigmoid         â”‚           â”‚
â”‚  â”‚     Output: [B, H, W, 1]                                 â”‚           â”‚
â”‚  â”‚     Confianza de presencia de objeto [0, 1]              â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                            â”‚
â”‚  FunciÃ³n de PÃ©rdida:                                                      â”‚
â”‚  â€¢ Classification: Focal Loss (para desbalance de clases)               â”‚
â”‚  â€¢ Bbox Regression: CIoU Loss (Complete IoU)                            â”‚
â”‚  â€¢ Objectness: Binary Cross-Entropy                                      â”‚
â”‚                                                                            â”‚
â”‚  Total Loss = Î»_cls * L_cls + Î»_bbox * L_bbox + Î»_obj * L_obj          â”‚
â”‚  donde Î»_cls=1.0, Î»_bbox=0.05, Î»_obj=0.5                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         POST-PROCESAMIENTO                                â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  1. NMS (Non-Maximum Suppression)                         â”‚           â”‚
â”‚  â”‚     â€¢ IoU threshold = 0.45                                â”‚           â”‚
â”‚  â”‚     â€¢ Elimina detecciones duplicadas                      â”‚           â”‚
â”‚  â”‚     â€¢ Mantiene caja con mayor confianza                   â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                               â”‚                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  2. Filtrado por Confianza                                â”‚           â”‚
â”‚  â”‚     â€¢ Threshold = 0.70                                    â”‚           â”‚
â”‚  â”‚     â€¢ Solo mantiene detecciones confiables                â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                               â”‚                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  3. DeepSORT Tracking                                     â”‚           â”‚
â”‚  â”‚     â€¢ Asigna ID Ãºnico a cada detecciÃ³n                    â”‚           â”‚
â”‚  â”‚     â€¢ Tracking multi-frame                                â”‚           â”‚
â”‚  â”‚     â€¢ Kalman filter para predicciÃ³n                       â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                               â”‚                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  4. ClasificaciÃ³n Estadio Larval                          â”‚           â”‚
â”‚  â”‚     â€¢ L1: < 5mm                                           â”‚           â”‚
â”‚  â”‚     â€¢ L2: 5-10mm                                          â”‚           â”‚
â”‚  â”‚     â€¢ L3+: > 10mm                                         â”‚           â”‚
â”‚  â”‚     Basado en tamaÃ±o de bounding box                      â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
        OUTPUT: List[Detection(bbox, conf, class, track_id, stage)]


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MÃ“DULO DE FUSIÃ“N MULTIMODAL                            â”‚
â”‚                 (Mejora precisiÃ³n con datos contextuales)                 â”‚
â”‚                                                                            â”‚
â”‚    Features CNN (1024-d)                 Datos Ambientales (5-d)         â”‚
â”‚    (del Backbone)                        (API externa/usuario)           â”‚
â”‚           â”‚                                      â”‚                        â”‚
â”‚           â”‚                                      â”‚                        â”‚
â”‚           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                        â”‚
â”‚           â”‚  â”‚   Global Average Pooling     â”‚  â”‚                        â”‚
â”‚           â”‚  â”‚   1024 â†’ 1024 features       â”‚  â”‚                        â”‚
â”‚           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                        â”‚
â”‚           â”‚                â”‚                    â”‚                        â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                            â”‚                                              â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚              â”‚    ConcatenaciÃ³n          â”‚                               â”‚
â”‚              â”‚    (1024 + 5 = 1029)      â”‚                               â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                            â”‚                                              â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚              â”‚   Fully Connected 1       â”‚                               â”‚
â”‚              â”‚   1029 â†’ 512 neurons      â”‚                               â”‚
â”‚              â”‚   ReLU + Dropout(0.3)     â”‚                               â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                            â”‚                                              â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚              â”‚   Fully Connected 2       â”‚                               â”‚
â”‚              â”‚   512 â†’ 256 neurons       â”‚                               â”‚
â”‚              â”‚   ReLU + Dropout(0.3)     â”‚                               â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                            â”‚                                              â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚              â”‚   Output Layer            â”‚                               â”‚
â”‚              â”‚   256 â†’ 2 neurons         â”‚                               â”‚
â”‚              â”‚   Softmax activation      â”‚                               â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                            â”‚                                              â”‚
â”‚                            â–¼                                              â”‚
â”‚              [P(Negativo), P(Positivo)]                                  â”‚
â”‚                                                                            â”‚
â”‚  Variables Ambientales de Entrada:                                       â”‚
â”‚  1. Temperatura Â°C (range: 15-35)                                        â”‚
â”‚  2. Humedad relativa % (range: 40-90)                                    â”‚
â”‚  3. FenologÃ­a del cultivo (codificado 0-5)                               â”‚
â”‚     0=vegetativo, 1=floraciÃ³n, 2=cuajado, 3=desarrollo, 4=maduraciÃ³n    â”‚
â”‚  4. Hora del dÃ­a (0-23)                                                  â”‚
â”‚  5. DÃ­a juliano del aÃ±o (1-365)                                          â”‚
â”‚                                                                            â”‚
â”‚  Fuente de Datos:                                                         â”‚
â”‚  â€¢ Usuario introduce manualmente en app                                  â”‚
â”‚  â€¢ API de WeatherAPI.com para TÂ° y humedad                              â”‚
â”‚  â€¢ GPS + timestamp del smartphone                                        â”‚
â”‚                                                                            â”‚
â”‚  Beneficio del Enfoque Multimodal:                                       â”‚
â”‚  â€¢ Mejora precisiÃ³n en 3-5% vs solo visiÃ³n                              â”‚
â”‚  â€¢ Reduce falsos positivos en condiciones ambientales desfavorables      â”‚
â”‚  â€¢ Permite predicciÃ³n de riesgo futuro                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**MÃ©tricas de Rendimiento del Modelo:**

| MÃ©trica | Valor | Nota |
|---------|-------|------|
| **PrecisiÃ³n (mAP@0.5)** | 96.2% | En dataset de validaciÃ³n |
| **Recall** | 93.8% | Sensibilidad a detecciones |
| **F1-Score** | 0.95 | Balance precision-recall |
| **Inferencia GPU** | ~45 ms/imagen | NVIDIA T4 |
| **Inferencia CPU** | ~320 ms/imagen | Intel Xeon |
| **Throughput** | 22 img/segundo | GPU T4 |
| **TamaÃ±o modelo** | 25.4 MB | Optimizado con ONNX |
| **Falsos Positivos** | 3.2% | En condiciones normales |
| **Falsos Negativos** | 4.1% | Principalmente en L1 muy pequeÃ±o |

---

## 5. FLUJO DE OPERACIÃ“N DEL SISTEMA

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   FLUJO COMPLETO DE DETECCIÃ“N                            â”‚
â”‚               Desde Captura hasta Resultado Final                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    [INICIO]
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 1: CAPTURA CON SMARTPHONE      â”‚
â”‚                                       â”‚
â”‚  Usuario (agricultor/tÃ©cnico):       â”‚
â”‚  â€¢ Abre PWA en navegador             â”‚
â”‚  â€¢ Enfoca planta de arÃ¡ndano         â”‚
â”‚  â€¢ Captura foto con cÃ¡mara           â”‚
â”‚  â€¢ Opcional: AÃ±ade datos manuales    â”‚
â”‚    - Lote/parcela                    â”‚
â”‚    - Temperatura estimada            â”‚
â”‚    - Etapa fenolÃ³gica                â”‚
â”‚                                       â”‚
â”‚  Metadata AutomÃ¡tica:                â”‚
â”‚  â€¢ GPS coordinates                    â”‚
â”‚  â€¢ Timestamp                          â”‚
â”‚  â€¢ Device info                        â”‚
â”‚  â€¢ Image quality (resoluciÃ³n)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 2: VALIDACIÃ“N LOCAL (PWA)      â”‚
â”‚                                       â”‚
â”‚  JavaScript Frontend:                â”‚
â”‚  âœ“ Verifica tamaÃ±o imagen (< 10MB)  â”‚
â”‚  âœ“ Verifica formato (JPG/PNG)        â”‚
â”‚  âœ“ Comprime si es necesario          â”‚
â”‚  âœ“ Preview para confirmar            â”‚
â”‚  âœ“ Muestra barra de progreso         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 3: UPLOAD AL SERVIDOR          â”‚
â”‚                                       â”‚
â”‚  POST /api/v1/detection/upload       â”‚
â”‚  Headers:                             â”‚
â”‚  â€¢ Authorization: Bearer <JWT>       â”‚
â”‚  â€¢ Content-Type: multipart/form-data â”‚
â”‚                                       â”‚
â”‚  Body:                                â”‚
â”‚  â€¢ image: File                        â”‚
â”‚  â€¢ metadata: JSON {                  â”‚
â”‚      gps, timestamp, user_notes      â”‚
â”‚    }                                  â”‚
â”‚                                       â”‚
â”‚  Response esperado:                   â”‚
â”‚  â€¢ 201 Created                        â”‚
â”‚  â€¢ task_id: UUID                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 4: COLA DE PROCESAMIENTO       â”‚
â”‚                                       â”‚
â”‚  Redis Queue:                         â”‚
â”‚  â€¢ AÃ±ade task a cola 'detection'     â”‚
â”‚  â€¢ Priority: normal (puede ser high) â”‚
â”‚  â€¢ TTL: 5 minutos                    â”‚
â”‚  â€¢ Retry: 3 intentos                 â”‚
â”‚                                       â”‚
â”‚  EstimaciÃ³n de tiempo:                â”‚
â”‚  â€¢ Sin cola: ~2 segundos             â”‚
â”‚  â€¢ Con cola: ~10-30 segundos         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 5: PREPROCESAMIENTO            â”‚
â”‚                                       â”‚
â”‚  Detection Service (FastAPI):        â”‚
â”‚  1. Load imagen desde S3             â”‚
â”‚  2. Resize letterbox â†’ 640x640       â”‚
â”‚  3. Normalize RGB [0,1]              â”‚
â”‚  4. Apply CLAHE (contrast)           â”‚
â”‚  5. Convert to tensor                â”‚
â”‚  6. Move to GPU memory               â”‚
â”‚                                       â”‚
â”‚  Tiempo promedio: ~200 ms            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 6: INFERENCIA ML               â”‚
â”‚                                       â”‚
â”‚  YOLOv8 + CBAM Model:                â”‚
â”‚  â€¢ Batch size: 1                     â”‚
â”‚  â€¢ Forward pass                      â”‚
â”‚  â€¢ Detect objects                    â”‚
â”‚  â€¢ Extract features                  â”‚
â”‚                                       â”‚
â”‚  Tiempo promedio: ~45 ms (GPU T4)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 7: FUSIÃ“N MULTIMODAL           â”‚
â”‚                                       â”‚
â”‚  Si hay datos ambientales:           â”‚
â”‚  â€¢ Fetch weather API                 â”‚
â”‚  â€¢ Combine CNN features + env data   â”‚
â”‚  â€¢ MLP classification                â”‚
â”‚  â€¢ Adjust confidence score           â”‚
â”‚                                       â”‚
â”‚  Tiempo promedio: ~20 ms             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 8: POST-PROCESAMIENTO          â”‚
â”‚                                       â”‚
â”‚  â€¢ Apply NMS (IoU=0.45)              â”‚
â”‚  â€¢ Filter by confidence (>0.70)      â”‚
â”‚  â€¢ DeepSORT tracking (si mÃºltiples)  â”‚
â”‚  â€¢ Classify larval stage             â”‚
â”‚  â€¢ Draw bounding boxes               â”‚
â”‚  â€¢ Generate heatmap                  â”‚
â”‚                                       â”‚
â”‚  Tiempo promedio: ~100 ms            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Â¿DetecciÃ³n?   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
         SI â”‚    â”‚ NO
            â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 9A: ALERTA     â”‚  â”‚  PASO 9B: NEGATIVO   â”‚
â”‚                      â”‚  â”‚                      â”‚
â”‚  Si detecta plaga:   â”‚  â”‚  Si NO detecta:      â”‚
â”‚  â€¢ Severity: Alta    â”‚  â”‚  â€¢ Log resultado     â”‚
â”‚  â€¢ Trigger alert svc â”‚  â”‚  â€¢ Update stats      â”‚
â”‚  â€¢ Send push notif   â”‚  â”‚  â€¢ No envÃ­a alerta   â”‚
â”‚  â€¢ Email tÃ©cnico     â”‚  â”‚                      â”‚
â”‚  â€¢ Update dashboard  â”‚  â”‚  Respuesta:          â”‚
â”‚                      â”‚  â”‚  {                   â”‚
â”‚  Respuesta:          â”‚  â”‚    "status": "ok",   â”‚
â”‚  {                   â”‚  â”‚    "detected": false â”‚
â”‚    "status": "alert",â”‚  â”‚  }                   â”‚
â”‚    "detected": true, â”‚  â”‚                      â”‚
â”‚    "count": 3,       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚    "stage": "L2",    â”‚             â”‚
â”‚    "confidence": 0.94â”‚             â”‚
â”‚  }                   â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
           â”‚                         â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 10: ALMACENAMIENTO             â”‚
â”‚                                       â”‚
â”‚  PostgreSQL:                          â”‚
â”‚  â€¢ INSERT detection record            â”‚
â”‚  â€¢ Link to user_id                    â”‚
â”‚  â€¢ Store GPS, timestamp               â”‚
â”‚  â€¢ Store detection results            â”‚
â”‚                                       â”‚
â”‚  MongoDB:                             â”‚
â”‚  â€¢ Store original image               â”‚
â”‚  â€¢ Store processed image              â”‚
â”‚  â€¢ Store full metadata                â”‚
â”‚                                       â”‚
â”‚  S3:                                  â”‚
â”‚  â€¢ Upload annotated image             â”‚
â”‚  â€¢ Path: processed/{user}/{date}/     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 11: NOTIFICACIÃ“N AL USUARIO    â”‚
â”‚                                       â”‚
â”‚  WebSocket (en tiempo real):         â”‚
â”‚  â€¢ Emit event 'detection_complete'   â”‚
â”‚  â€¢ Payload: {task_id, results}       â”‚
â”‚                                       â”‚
â”‚  Push Notification (si alerta):      â”‚
â”‚  â€¢ Title: "âš ï¸ Plaga detectada"       â”‚
â”‚  â€¢ Body: "3 larvas L2 en Lote A"     â”‚
â”‚  â€¢ Action: Abrir mapa                â”‚
â”‚                                       â”‚
â”‚  Email (si severidad alta):          â”‚
â”‚  â€¢ To: tÃ©cnico responsable           â”‚
â”‚  â€¢ Subject: "Alerta Heliothis"       â”‚
â”‚  â€¢ Body: Detalles + imagen           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 12: ACTUALIZAR DASHBOARD       â”‚
â”‚                                       â”‚
â”‚  Frontend recibe evento:              â”‚
â”‚  â€¢ Refresh detection list            â”‚
â”‚  â€¢ Update heatmap                    â”‚
â”‚  â€¢ Update statistics                 â”‚
â”‚  â€¢ Show annotated image              â”‚
â”‚  â€¢ Suggest actions                   â”‚
â”‚                                       â”‚
â”‚  Analytics:                           â”‚
â”‚  â€¢ Increment detection counter       â”‚
â”‚  â€¢ Update infestation rate           â”‚
â”‚  â€¢ Feed ML prediction model          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
         [FIN]

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TIEMPOS TOTALES (PROMEDIOS)                           â”‚
â”‚                                                                           â”‚
â”‚  Sin cola, conexiÃ³n Ã³ptima:     ~2.5 segundos                           â”‚
â”‚  Con cola moderada (5 imgs):    ~15 segundos                            â”‚
â”‚  Con cola alta (20+ imgs):      ~45 segundos                            â”‚
â”‚                                                                           â”‚
â”‚  Desglose tÃ­pico (sin cola):                                            â”‚
â”‚  â€¢ Upload: 800 ms                                                        â”‚
â”‚  â€¢ Preproceso: 200 ms                                                    â”‚
â”‚  â€¢ Inferencia: 45 ms                                                     â”‚
â”‚  â€¢ Multimodal: 20 ms                                                     â”‚
â”‚  â€¢ Post-proceso: 100 ms                                                  â”‚
â”‚  â€¢ Almacenar: 150 ms                                                     â”‚
â”‚  â€¢ Notificar: 50 ms                                                      â”‚
â”‚  â€¢ Overhead: 135 ms                                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                   â”‚
â”‚  TOTAL: ~2.5 segundos                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. STACK TECNOLÃ“GICO COMPLETO

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                     TECNOLOGÃAS 2025 - RESUMEN                        â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                       â•‘
â•‘  FRONTEND & MÃ“VIL                                                    â•‘
â•‘  â€¢ React 18.3 + TypeScript 5.3                                       â•‘
â•‘  â€¢ Material-UI (MUI) v5.15                                           â•‘
â•‘  â€¢ Progressive Web App (PWA)                                         â•‘
â•‘  â€¢ React Query + Zustand                                             â•‘
â•‘  â€¢ Recharts + Leaflet Maps                                           â•‘
â•‘  â€¢ Vite 5.0 (build tool)                                             â•‘
â•‘                                                                       â•‘
â•‘  BACKEND & API                                                       â•‘
â•‘  â€¢ FastAPI 0.115 (Python 3.11)                                       â•‘
â•‘  â€¢ Uvicorn (ASGI server)                                             â•‘
â•‘  â€¢ Pydantic v2 (validaciÃ³n)                                          â•‘
â•‘  â€¢ Node.js 20 LTS + Express                                          â•‘
â•‘  â€¢ Socket.IO (WebSocket)                                             â•‘
â•‘                                                                       â•‘
â•‘  DEEP LEARNING & AI                                                  â•‘
â•‘  â€¢ PyTorch 2.5 + CUDA 12.1                                           â•‘
â•‘  â€¢ Ultralytics YOLOv8                                                â•‘
â•‘  â€¢ TorchVision 0.20                                                  â•‘
â•‘  â€¢ OpenCV 4.10                                                       â•‘
â•‘  â€¢ Albumentations 1.4                                                â•‘
â•‘  â€¢ ONNX Runtime 1.19                                                 â•‘
â•‘                                                                       â•‘
â•‘  BASES DE DATOS                                                      â•‘
â•‘  â€¢ PostgreSQL 16.4                                                   â•‘
â•‘  â€¢ MongoDB 7.0                                                       â•‘
â•‘  â€¢ Redis 7.4                                                         â•‘
â•‘                                                                       â•‘
â•‘  CLOUD (AWS)                                                         â•‘
â•‘  â€¢ EC2 g4dn.xlarge (GPU T4)                                          â•‘
â•‘  â€¢ S3 (storage)                                                      â•‘
â•‘  â€¢ RDS PostgreSQL                                                    â•‘
â•‘  â€¢ DocumentDB (MongoDB API)                                          â•‘
â•‘  â€¢ ElastiCache Redis                                                 â•‘
â•‘  â€¢ EKS (Kubernetes)                                                  â•‘
â•‘  â€¢ CloudFront (CDN)                                                  â•‘
â•‘  â€¢ Route 53 (DNS)                                                    â•‘
â•‘  â€¢ CloudWatch (monitoring)                                           â•‘
â•‘                                                                       â•‘
â•‘  MESSAGE BROKER                                                      â•‘
â•‘  â€¢ RabbitMQ 3.13 / Amazon SQS                                        â•‘
â•‘                                                                       â•‘
â•‘  CONTAINERIZACIÃ“N                                                    â•‘
â•‘  â€¢ Docker 27                                                         â•‘
â•‘  â€¢ Kubernetes 1.31                                                   â•‘
â•‘  â€¢ Helm 3.16                                                         â•‘
â•‘                                                                       â•‘
â•‘  CI/CD & DevOps                                                      â•‘
â•‘  â€¢ GitHub Actions                                                    â•‘
â•‘  â€¢ ArgoCD (GitOps)                                                   â•‘
â•‘  â€¢ Terraform (IaC)                                                   â•‘
â•‘                                                                       â•‘
â•‘  MONITORING                                                          â•‘
â•‘  â€¢ Prometheus + Grafana                                              â•‘
â•‘  â€¢ CloudWatch Logs                                                   â•‘
â•‘  â€¢ Sentry (error tracking)                                           â•‘
â•‘                                                                       â•‘
â•‘  SEGURIDAD                                                           â•‘
â•‘  â€¢ OAuth 2.0 + JWT                                                   â•‘
â•‘  â€¢ SSL/TLS (Let's Encrypt)                                           â•‘
â•‘  â€¢ AWS WAF                                                           â•‘
â•‘  â€¢ bcrypt (passwords)                                                â•‘
â•‘                                                                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 7. CONCLUSIONES Y RECOMENDACIONES

### Ventajas de la SoluciÃ³n Propuesta

âœ… **Accesibilidad**: Solo requiere smartphone, sin hardware especializado  
âœ… **Escalabilidad**: Cloud-native con auto-scaling automÃ¡tico  
âœ… **PrecisiÃ³n**: >95% mAP con deep learning state-of-the-art  
âœ… **Velocidad**: Resultados en ~2.5 segundos  
âœ… **Multimodal**: Combina visiÃ³n + datos ambientales  
âœ… **Costo-efectivo**: Pago por uso en AWS, sin inversiÃ³n inicial grande  
âœ… **Mantenible**: Arquitectura de microservicios independientes  

### Limitaciones y Consideraciones

âš ï¸ **Dependencia de Conectividad**: Requiere internet (4G/5G/WiFi)  
âš ï¸ **Calidad de Imagen**: Resultados Ã³ptimos con buena iluminaciÃ³n  
âš ï¸ **Curva de Aprendizaje**: Usuarios deben capacitarse en captura correcta  
âš ï¸ **Costos Cloud**: Escala de costos con nÃºmero de usuarios  

### Trabajo Futuro

ğŸ”® **Modo Offline**: Implementar TensorFlow Lite para inferencia local  
ğŸ”® **Dataset Expansion**: Aumentar a 50,000+ imÃ¡genes etiquetadas  
ğŸ”® **Multi-plaga**: Detectar 5+ especies de plagas simultÃ¡neas  
ğŸ”® **PredicciÃ³n**: ML para predecir brotes 7-14 dÃ­as adelante  
ğŸ”® **IA Generativa**: Recomendaciones personalizadas de control  

---

## 8. REFERENCIAS

**TecnologÃ­as utilizadas:**
- PyTorch: https://pytorch.org/
- YOLOv8: https://github.com/ultralytics/ultralytics
- FastAPI: https://fastapi.tiangolo.com/
- React: https://react.dev/
- AWS: https://aws.amazon.com/

**Papers de Referencia:**
- YOLO v8: "Real-Time Object Detection with YOLOv8" (2023)
- CBAM: "CBAM: Convolutional Block Attention Module" (2018)
- BiFPN: "EfficientDet: Scalable and Efficient Object Detection" (2020)

---

**Documento generado para:**  
Universidad Peruana de Ciencias Aplicadas (UPC)  
Facultad de IngenierÃ­a  
Programa de IngenierÃ­a de Software

**Autores:** [Tus nombres]  
**Fecha:** Noviembre 2025
